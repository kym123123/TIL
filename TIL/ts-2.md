# 타입스크립트

프로그래머가 작성한 텍스트(소스코드)가 프로그램으로 변화하는 과정

1. 텍스트를 컴파일러라는 프로그램이 파싱한다.
2. 파싱되면 추상문법트리(AST)라는 자료구조로 변환된다.
3. 컴파일러는 다시 AST를 바이트 코드라는 하위 수준의 표현으로 변환한다.
4. 변환된 바이트코드를 런타임이라는 다른 프로그램이 읽고 평가하여 프로그램이 동작된다.

타입스크립트 컴파일러는 코드를 바이트코드 대신 자바스크립트 코드로 변환한다. 그 이후에는 자바스크립트 코드를 실행하듯 브라우저, Node JS(런타임 환경)로 실행 가능하다.

타입스크립트 컴파일러(TSC)는 AST를 만들어 결과 코드를 내기 전에 타입 확인을 거친다. 

AST(sbstract syntax tree): 추상 구문 트리 (혹은 구문 트리), 프로그래밍 언어로 작성된 추상 구문 구조의 트리. 이 트리의 각 노드는 소스 코드에서 발생되는 구조를 나타낸다. 구문이 추상적이라는 의미는 실제 구문에서 나타내는 모든 정보를 세세하기 나타내지 않는다는 의미이다. AST는 컴파일러가 요구하는 여러 단계를 통해 프로그램의 중간 표현 역할을 한다. (출처: 위키피디아 추상구문트리)

* 타입스크립트 컴파일 및 실행과정

  : 1. 타입스크립트 소스코드(텍스트) -> 타입스크립트 AST 

  2. 타입 검사기가 AST를 확인
  3. 타입 스크립트 AST -> 자바스크립트 소스코드
  4. 자바스크립트 소스코드 -> 자바스크립트 AST
  5. AST -> 바이트 코드
  6. 런타임이 바이트 코드 평가

(js 컴파일러와 런타임은 js엔진이라는 하나의 프로그램으로 합쳐짐.)

* 개발자가 적은 타입은 프로그램에 아무런 영향을 주지 않고 타입 확인에만 사용된다.
* 타입교체에 의하여 기존 프로그램이 망가질 일은 없다.

## 타입스크립트 타입시스템

: 두가지 방식중 한가지를 선택 가능하다

1. 개발자가 타입을 명시한다.(타입 어노테이션)
2. 개발자가 작성한 코드를 통해 타입스크립트가 타입을 추론한다.

```typescript
// 어노테이션을 이용한 명시적 타입지정

let n:number = 1; // 숫자
let s:string = 'hello'; // 문자열
let booleanArray:boolean[] = [true, false]; // 불리언 배열

// 어노테이션을 사용하지 않고, ts가 타입을 추론하도록 함 (js방식)
let n = 1;
let s = 'hello';
let booleanArray = [true, false];
```

## javascript 와 typescript의 차이점

- javascript: 런타임시에 에러를 검출하고 타입을 확인한다. 타입은 동적으로 결정되며(동적 타입 바인딩;dynamic type binding; 프로그램 런타임시에 데이터 타입이 확인 가능) 식별자에 할당되는 값이 바뀔때 동적으로 타입도 결정된다.
- typescript: 컴파일시에 에러를 검출하고 타입을 확인한다. ts는 다른 정적 언어들처럼(c, java..) 타입 결정 방식이 정적이며, 대부분 자동으로 타입 변환이 되지 않는다. 

자바스크립트가 런타임에 발생시킬 에러를, 타입스크립트는 컴파일 단계에서 발생시켜 사전에 에러를 검출해 제거할 수 있도록 해준다.

## tsconfig.json 옵션

```json
// tsconfig.js

{
  "compilerOptions": {
    // tsc가 코드 실행환경에서 이용할수 있는 api(es2015의 여러 내장 함수들을 사용가능하다. ex:document.querySelector...등)
    "lib": ["ES2015"],
    
    // tsc가 코드를 컴파일할 모듈(common js)
    "module": "commonjs",
    
    // 생성된 js 파일을 위치시킬 경로
    "outDir": "dist",
    "sourceMap": true,
    
    // 코드검사시 적용할 엄격성, 코드가 적절히 타입을 갖도록 강제한다
    "strict": true,
    "target": "es2015"
  },
  // tsc가 ts파일을 찾는 경로
  "include": ["src"]
}
```

* ts는 실제 배포시에 js로 트랜스파일링 된 후에 배포된다. 따라서 ts로 개발하는 과정에서 수정시에 여러번 트랜스파일링을 해야 js로 실행 결과를 알 수 있다. 이러한 지연을 개선하기 위해서 ts-node를 사용할 수 있다. Ts-node는 메모리상으로 ts를 트랜스파일링 하여 바로 실행할 수 있도록 해준다.

* `npm i --save-dev typescript ts-node` 로 설치한다. 그리고 package.json 에서 아래와 같이 설정해주면 즉시 실행하여 결과확인이 가능하다.

  ```json
  // package.json
  
  // 실행할 파일 경로
  "script": {
  	"start": "ts-node ./src/index.ts"
  }
  ```

  